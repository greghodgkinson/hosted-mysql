app = 'hosted-mysql'
primary_region = 'iad'

# Use the official MySQL 8 container image
[build]
  image = 'mysql:8.0.37'

# Start MySQL with the native password plugin
[processes]
  app = "--default-authentication-plugin mysql_native_password"

# Environment variables for MySQL initialization
# (Passwords are in plain text; this is fine for testing but not recommended for production)
[env]
  MYSQL_DATABASE      = "test_db"
  MYSQL_USER          = "db_user"
  MYSQL_PASSWORD      = "db_password"
  MYSQL_ROOT_PASSWORD = "root_password"

# Expose the MySQL port publicly so external clients can connect directly
[[services]]
  internal_port = 3306
  protocol = "tcp"
  processes = ["app"]
  [[services.ports]]
    port = 3306

# Optional VM sizing
[[vm]]
  memory   = '1gb'
  cpu_kind = 'shared'
  cpus     = 1